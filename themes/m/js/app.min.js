$(document).ajaxSend(function(event,request,settings){$('.task-title').show();$('.task-separator').show();$('#inverted-contain').show();$('.loading').show();$('.darking').show();$('body,html').animate({scrollTop:480},200);});$(document).ajaxComplete(function(event,request,settings){var contHeight=$('.content').outerHeight();var sidebarHeight=$('.sidebar').outerHeight();if(contHeight>sidebarHeight){$('.sidebar').height(contHeight);}$('.loading').hide();$('.darking').hide();});$(document).ready(function(){$('.darking').click(function(){$(this).hide();$('.loading').hide();});$(window).scroll(function(){if($(this).scrollTop()!=0){$('#toTop').fadeIn();}else{$('#toTop').fadeOut();}});$('#toTop').click(function(){$('body,html').animate({scrollTop:0},100);});$('li.textbook').hover(function(){$(this).css({'background-color':'#f5f5f5','z-index':'10'});$('.textbook-table').css({'display':'block'});},function(){$('li.textbook').css({'background-color':'','z-index':'1'});$('.textbook-table').css({'display':'none'});});$('li.gdz').hover(function(){$(this).css({'background-color':'#f5f5f5','z-index':'10'});$('.gdz-table').css({'display':'block'});},function(){$('.gdz-table').css({'display':'none'});$('li.gdz').css({'background-color':'','z-index':'1'});});$('li.knowall').hover(function(){$(this).css({'background-color':'#f5f5f5','z-index':'10'});$('.knowall-block').css({'display':'block'});},function(){$('.knowall-block').css({'display':'none'});$('li.knowall').css({'background-color':'','z-index':'1'});});$('li.library').hover(function(){$(this).css({'background-color':'#f5f5f5','z-index':'10'});$('.library-block').css({'display':'block'});},function(){$('.library-block').css({'display':'none'});$('li.library').css({'background-color':'','z-index':'1'});});$('li.writing').hover(function(){$(this).css({'background-color':'#f5f5f5','z-index':'10'});$('.writing-table').css({'display':'block'});},function(){$('.writing-table').css({'display':'none'});$('li.writing').css({'background-color':'','z-index':'1'});});$('.view-filter').click(function(){var oldActiveView=$(this).siblings('.active-filter').data('view');var smallBtn=false;var newActiveView=$(this).data('view');if(newActiveView=='small-book-block'){smallBtn=true;}$('.view-filter').each(function(){$(this).removeClass('active-filter');$('.'+oldActiveView).each(function(){$(this).removeClass(oldActiveView).addClass(newActiveView);if(smallBtn){$(this).find('.gdz-link').find('a').removeClass('btn-sm').addClass('btn-xs');$(this).find('.textbook-link').find('a').removeClass('btn-sm').addClass('btn-xs');}else{$(this).find('.gdz-link').find('a').removeClass('btn-xs').addClass('btn-sm');$(this).find('.textbook-link').find('a').removeClass('btn-xs').addClass('btn-sm');}});});$(this).addClass('active-filter');});var clas=$('.clas-active').find('a').text();var clasActive='.clas-active-'+clas;var author=$('.task').find('span.author').data('author');var title=$('.task').find('span.title').data('title');$('.task-number').each(function(i,val){$(val).on('click',{'numb':$(val).data('url'),'parent':val},getTask);});function getTask(e){var numb=e.data.numb;var parent=e.data.parent;var fullUrl=location.href;if(fullUrl.indexOf('#')!=-1){var url=fullUrl.replace(/#.*/i,'')+'/'+numb;}else{var url=location.href+'/'+numb;}var book=$('.panzoom-parent');$.ajax({type:"post",url:url,data:{'mode':''},dataType:"html",success:function(reponse){window.location.hash=numb;$('.page-number').text(numb);$(book).html(reponse);var imgWidth=$(reponse).data('width');var imgHeight=$(reponse).data('height');var taskW=$('.task').width();if(imgWidth>taskW){resizeImage(imgWidth,imgHeight,taskW-10);}else{$('.task').find('img').css({'height':imgHeight+'px','width':imgWidth+'px'});}$('.task-r').each(function(){$(this).find('.task-active').removeClass('task-active').find('p').removeClass('bold');});$(parent).parents('.task-one').addClass('task-active').find('p').addClass('bold');var img=$('.task-img');var task=$('.task').width();if(img.data('width')<task){img.width(img.data('width'));}$('.task-title').css({'display':'block'});panZoomInit();}});}function panZoomInit(){var $section=$('#inverted-contain');$section.find('.panzoom').panzoom({$zoomIn:$section.find(".zoom-in"),$zoomOut:$section.find(".zoom-out"),$zoomRange:$section.find(".zoom-range"),$reset:$section.find(".reset"),startTransform:'scale(0.9)',increment:0.1,minScale:1,contain:'invert'}).panzoom('zoom');}function resizeImage(iW,iH,width){var ratio=width/iW;var w=Math.ceil(iW*ratio);var h=Math.ceil(iH*ratio);$('.task').find('img').css({'height':h+'px','width':w+'px'});}resizeContentBlock();function resizeContentBlock(){var contHeight=$('.content').outerHeight();var sidebarHeight=$('.sidebar').outerHeight();console.log('resize');console.log(sidebarHeight);console.log(contHeight);if(contHeight>sidebarHeight){$('.sidebar').height(contHeight);}console.log($('.sidebar').outerHeight());}function rotate(){setInterval(function(){var src=$('.big_adsance').attr('src');if(src.indexOf('banner')!=-1){$('.big_adsance').attr('src','/images/big.jpeg');}else{$('.big_adsance').attr('src','/images/banner.png');}},10000);}function showFb(){$.cookie('showFb','showFb',{expires:1,path:'/',});$('#fb-modal').modal('show');}$('td , th').hover(function(){var vertical=$(this).data('vertical');$("[data-vertical='"+vertical+"']").each(function(i,item){$(item).css({'background':'#eee'});});$(this).css({'background':'#d3e4ff'});},function(){var vertical=$(this).data('vertical');$("[data-vertical='"+vertical+"']").each(function(i,item){$(item).css({'background':'inherit'});});$(this).css({'background':'inherit'});});$(window).scroll(function(){if($(this).scrollTop()>45&&$('.header').hasClass("fixed-menu")==false){$('.header').fadeOut('fast',function(){$(this).addClass("fixed-menu").fadeIn('fast');});}else if($(this).scrollTop()<=45&&$('.header').hasClass("fixed-menu")){$('.header').fadeOut('fast',function(){$(this).removeClass("fixed-menu").fadeIn('fast');});}});$('.b-left').click(function(){var activeTask=$('.task-one').filter('.task-active');var prevTask=$(activeTask).prev('.task-one');if(activeTask&&prevTask){$(prevTask).find('.task-number').click();}});$('.b-right').click(function(){var activeTask=$('.task-one').filter('.task-active');var nextTask=$(activeTask).next('.task-one');if(activeTask&&nextTask){$(nextTask).find('.task-number').click();}});$('.yiiPager').find('.disabled').each(function(){$(this).find('a').click(function(e){e.preventDefault();});});$('[data-url=1]').click();function linksUp(){$('a[data-key]').each(function(i,v){$(this).attr('href',Base64.decode($(this).attr('data-key')));});}linksUp();});